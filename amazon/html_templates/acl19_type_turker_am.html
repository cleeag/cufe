<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>

<crowd-form onsubmit="return confirm('Do you really want to submit the answer?');">
    <!-- Bootstrap v3.0.3 -->
    <meta charset="UTF-8">

    <link href="https://s3.amazonaws.com/mturk-public/bs30/css/bootstrap.min.css" rel="stylesheet"/>
    <section class="container" id="Other"
             style="margin-bottom: 15px; padding: 10px; font-family: Verdana, Geneva, sans-serif; font-size: 1em;">

        <div class="row col-xs-12 col-md-12"><!-- Instructions -->
            <div class="panel panel-primary">
                <div class="panel-heading" style="color: rgb(51, 51, 51);"><span
                        style="strong;color:white;">Instructions </span><span onclick="myFunction()"
                                                                              style="text-decoration:underline;color:white;cursor:pointer">[Hide/Show]</span>
                </div>

                <div id="myDIV">
                    <div class="panel-body">


                        <p style="color: rgb(51, 51, 51);">This task is to infer the "types" of
                            <mark>highlighted term</mark>
                            in
                            the provided sentence.&nbsp;
                        </p>

                        <p style="color: rgb(51, 51, 51);">For each assignment, there will be a highlighted term for you
                            to annotate.
                        </p>
                        <p>As you type, a dropdown menu will appear. Please select two
                            <b>specific type labels</b> from the dropdown menu in each slot.</p>

                        <p>Your answer form is at the bottom of the page.</p>

                        <h3>*** This is &nbsp;<font color="#ff0000"><b>not a translation task!!</b></font>&nbsp;The goal
                            is to get the <font color="#ff0000"><b>type/category</b></font> for the targeted term.***</h3>

                        <br style="margin-bottom:240px;"/>

                        <p style="color: rgb(51, 51, 51);"><strong><em>Here we provide some examples for the
                            task:</em></strong></p>

                        <table border="3" cellpadding="5" cellspacing="2"
                               style="color: rgb(51, 51, 51); font-size: 1em;">
                            <colgroup>
                                <col span="1" style="width: 65%;"/>
                                <col span="1" style="width: 30%;"/>
                                <col span="1" style="width: 5%;"/>
                            </colgroup>
                            <tbody>
                            <tr>
                                <td align="center"><strong>Sentence</strong></td>
                                <td rowspan="1" align="center"><b>Specific Types</b></td>
                                <td align="center"><b>Error</b></td>
                            </tr>
                            <tr>
                                <td>
                                    电影《画皮II》导演乌尔善、制片人
                                    <mark>庞洪</mark>
                                    、出品人郭力以及中央美术学院教授王水泊在中央美术学院美术馆学术报告厅进行了题为《电影“画皮Ⅱ”的思考与回顾》的讲座
                                </td>
                                <td><p>1. producer</p>
                                    <p>2. film maker</p></td>
                                <td><input  type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td>
                                    轿车在
                                    <mark>印度</mark>
                                    市场上的地位日益重要，而日产阳光能够最大程度上满足消费者对精致、实用及高性价比车型的需要
                                </td>
                                <td><p>1. country</p>
                                    <p>2. location</p></td>
                                <td><input  type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td>
                                    农妇满脸丰收喜悦,
                                    向我们这些分享她劳动成果的城里人连连地说:『你们随便挑哇,
                                    <mark>咱</mark>
                                    自家种的,八月十五快到了,买回去全家吃个鲜
                                </td>
                                <td><p>1. farmer</p>
                                    <p>2. woman</p></td>
                                <td><input  type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td>
                                    凯基证券分析师Kuo对苹果2012年下半年的“战况”进行了预测，Kuo认为，13英寸的
                                    <mark>Retina显示屏</mark>
                                    MacBook Pro以及最新款的MacBook Air对消费者的吸引力非常大
                                </td>
                                <td><p>1. screen</p>
                                    <p>2. technology</p></td>
                                <td><input  type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td>
                                    毛泽东与柳亚子畅游
                                    <mark>颐和园</mark>
                                    ，就是其中最为典型的一例
                                </td>
                                <td><p>1. garden</p>
                                    <p>2. attraction</p></td>
                                <td><input  type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td>
                                    <mark>他</mark>
                                    说,中国认为,国家不分大小、强弱和贫富,都是国际社会中平等的一员。
                                    李岚清表示,中国愿意加强与爱沙尼亚在各个领域、特别是经贸领域的友好合作关系。
                                </td>
                                <td><p>1. speaker</p>
                                    <p>2. person</p></td>
                                <td><input  type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td>
                                    <mark>张南</mark>
                                    也不好反对，就交出了钥匙
                                </td>
                                <td>person</td>
                                <td><input checked="yes"  type="checkbox"/></td>
                            </tr>
                            <tr>
                                <td>

                                    晚会上当地的华人艺术家们演奏了精彩的中国民乐,田鸣的一首《大中国》和另一首《
                                    <mark>我</mark>爱你中国》将晚会的气氛推向了高潮
                                </td>
                                <td>&nbsp;</td>
                                <td><input checked="yes" type="checkbox"/></td>
                            </tr>
                            </tbody>
                        </table>

                        <p></p>
                        <p style="color: rgb(51, 51, 51);">* Please select a type/label for the highlighted term
                            from the <strong>dropdown menu</strong> in each slot.
                        </p>

                        <p>
                            * We aim to obtain the <b>more specific</b> types for each of the highlighted term. E.g.,
                            for the first example on top,
                            <mark>庞洪</mark>
                            , please try to annotate it as labels similar to "producer" or "film maker" instead of
                            simply "person" or "man."
                        </p>
                        <p>
                            * Types are <strong>inferred</strong> from the context or<strong> well-known</strong> types
                            that fits the context.
                        </p>
                        <p>
                            * If the context doesn't provide enough information, please annotate the highlighted terms
                            with more <strong>general</strong> types such as "person", "object" or "location", etc., or
                            the more <strong>well known</strong> types for it.
                        </p>

                        <p style="color: rgb(51, 51, 51);"><strong><em>Annotation details:</em></strong></p>



                        <p>* Please fill-in <b>every</b> slots in the “specific types” with different types unless you check the
                            <strong>Error</strong> checkbox.</p>

                        <p>
                            * If the sentence does not provide enough information and you cannot fill in the two slots,
                            you can leave one or both of them blank and mark the
                            <strong>Error</strong> checkbox.
                            Also mark the checkbox if the highlighted term simply doesn't make sense. (last two
                            examples)
                        </p>
                        <p>
                            * Please
                            read the sentence carefully and mark the checkbox&nbsp;<strong>only when&nbsp;necessary</strong>. For each
                            task with five sentences, we assume <strong>no more than two</strong> example should be marked as error.&nbsp;
                        </p>

                        <p style="color: rgb(51, 51, 51);"><strong><em>Common Mistakes:</em></strong></p>
                        <p>Incorrect types are written in <strong><span style="color:#FF0000;">red</span></strong>,
                            correct types in <strong><span style="color:#008000;">green</span></strong>.
                        </p>
                        <table border="3" cellpadding="5" cellspacing="2"
                               style="color: rgb(51, 51, 51); font-size: 1em;">
                            <colgroup>
                                <col span="1" style="width: 65%;"/>
                                <col span="1" style="width: 30%;"/>
                                <col span="1" style="width: 5%;"/>
                            </colgroup>
                            <tbody>
                            <tr>
                                <td align="center"><strong>Sentence</strong></td>
                                <td rowspan="1" align="center"><b>Specific Types</b></td>
                                <td align="center"><b>Error</b></td>
                            </tr>
                            <tr>
                                <td>方形塔楼一统天下的格局已被打破，各种X形、
                                    <mark>Y形</mark>
                                    、蝶形等设计方案将使每套住户都有朝阳的房间
                                </td>
                                <td><p>1. <span style="color:#008000;">Shape</span></p>
                                    <p>2. <span style="color:#FF0000;">object</span></p></td>
                                <td><input type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td colspan="3">Explanation: Y-shape is a certain shape and form,
                                    not an object
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    韩素云朴实地说:“我把照片挂在这里，是时刻提醒<mark>自己</mark>:只有努力工作、努力学习，才能回报党和人民给我的荣誉
                                </td>
                                <td><p>1. <span style="color:#008000;">person</span></p>
                                    <p>2. <span style="color:#FF0000;">self</span></p></td>
                                <td><input type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td colspan="3">Explanation: "self" is not a type
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    本轮
                                    <mark>华盛顿</mark>
                                    将在主场迎战东区排名垫底的芝加哥火焰，虽说最近两次交手遭遇连败，但这也是两队最近10次碰面，华盛顿联仅有的两场失利
                                </td>
                                <td>
                                    <p>1. <span style="color:#008000;">sports team</span></p>
                                    <p>2. <span style="color:#008000;">organization</span></p>
                                    <p>3. <span style="color:#FF0000;">person</span></p>
                                    <p>4. <span style="color:#FF0000;">location</span></p>
                                <td><input type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td colspan="3">Explanation: Here 华盛顿 refers to a sports team. It shouldn't be
                                    labeled as location. It is not accepted to label it as person, as it is not
                                    referring to George Washington.
                                </td>
                            </tr>
                            <tr>
                                <td>上排左起：孙毅、
                                    <mark>尚秀云</mark>
                                    、杨艺文、王振林、谭竹青。
                                </td>
                                <td><p>1. <span style="color:#008000;">person</span></p>
                                    <p>2. <span style="color:#FF0000;">man</span></p></td>
                                <td><input type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td colspan="3">Explanation: We can only conclude that 尚秀云 is a person.
                                    In fact, the <strong>error checkbox</strong> should be marked
                                    as the context did not provide enough information.
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <mark>阿诺</mark>
                                    表示：“还有一个最大的损失是，我没有太多时间陪家人，这是今后我最应弥补的。”他说，
                                    开始担任州长时，每周一早上就从洛杉矶的家里直奔加州州府，直到周末才能回来，家人还因此抱怨
                                </td>
                                <td><p>1. <span style="color:#008000;">governer</span></p>
                                    <p>2. <span style="color:#008000;">government official</span></p>
                                    <p>3. <span style="color:#FF0000;">actor</span></p>
                                </td>
                                <td><input type="checkbox" disabled/></td>
                            </tr>
                            <tr>
                                <td colspan="3">Explanation: From the context, 阿诺 refers to him as a governer,
                                    so it is not recommended to label him as an actor in this case.
                                    If the context does not provide enough information, please use your
                                    <strong>commen sense</strong> to make a choice of the label.
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <p style="color: rgb(51, 51, 51);"><span
                        >The followings&nbsp;</span><strong
                        ><span style="color: rgb(255, 0, 0);">are not</span></strong><span
                        >&nbsp;considered as types: Pronouns&nbsp;</span><span
                        >(i.e., you, them, they, I, it, he, she, self), Quantifying expressions</span><span
                        >&nbsp;(i.e., all, both, many), Names (i.e., Jon, Mary, George, USA, ), Adjective or adverb (i.e., ancient, beautiful, religious),
                            Grammatical terms (i.e. noun, pronoun, verb, adjective).</span>
                        </p>
                        <p><font color="#ff0000"><b></b></font></p>

                        <h3>*** <font color="#ff0000"><b>Not every selection in the dropdown menu is an eligible
                            type!!</b></font>***</h3>

                        <br style="margin-bottom:240px;"/>
                        <p style="color: rgb(51, 51, 51);"><strong><em>Feel free to send questions, and thank you for
                            your
                            interest
                            in the task!</em></strong></p>
                    </div>
                </div>
            </div>


            <section style="color: rgb(51, 51, 51);">
                <div style="display:none;">${mention_id_1}${mention_id_2}${mention_id_3}${mention_id_4}${mention_id_5}
                </div>

                <fieldset>
                    <table border="3" cellpadding="15" cellspacing="2" style="font-size:1em;">
                        <colgroup>
                            <col span="1" style="width: 65%;"/>
                            <col span="1" style="width: 30%;"/>
                            <col span="1" style="width: 5%;"/>

                        </colgroup>
                        <tbody>

                        <tr>
                            <td align="center"><strong>Sentence</strong></td>
                            <td rowspan="1" align="center"><b
                                    style="font-family: Verdana, Geneva, sans-serif; font-size: 11.7px;">Specific
                                Types</b>
                            </td>
                            <td align="center"><b>Error</b></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">${s1}
                            </td>
                            <td><input class="form-control" name="FineTypeA0" size="15" type="text"  placeholder="Start typing here..."/>
                                <p></p><input class="form-control" name="FineTypeB0" size="15" type="text"  placeholder="Start typing here..."/></td>
                            <td><input name="NA0" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">${s2}
                            </td>
                            <td><input class="form-control" name="FineTypeA1" size="15" type="text"  placeholder="Start typing here..."/>
                                <p></p><input class="form-control" name="FineTypeB1" size="15" type="text"  placeholder="Start typing here..."/></td>
                            <td><input name="NA1" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">${s3}
                            </td>
                            <td><input class="form-control" name="FineTypeA2" size="15" type="text"  placeholder="Start typing here..."/>
                                <p></p><input class="form-control" name="FineTypeB2" size="15" type="text"  placeholder="Start typing here..."/></td>
                            <td><input name="NA2" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">${s4}
                            </td>
                            <td><input class="form-control" name="FineTypeA3" size="15" type="text"  placeholder="Start typing here..."/>
                                <p></p><input class="form-control" name="FineTypeB3" size="15" type="text"  placeholder="Start typing here..."/></td>
                            <td><input name="NA3" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">${s5}
                            </td>
                            <td><input class="form-control" name="FineTypeA4" size="15" type="text"  placeholder="Start typing here..."/>
                                <p></p><input class="form-control" name="FineTypeB4" size="15" type="text"  placeholder="Start typing here..."/></td>
                            <td><input name="NA4" type="checkbox"/></td>
                        </tr>
                        </tbody>
                    </table>
                </fieldset>
            </section>


            <link href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css" rel="stylesheet"/>
            <script src="//code.jquery.com/jquery-1.10.2.js"></script>
            <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
            <script src="https://s3.amazonaws.com/MY89_js/jquery.cookie.js"></script>
            <script src="https://cleeag.github.io/files/cufe_ontology.js"></script>

            <script>
                function myFunction() {
                    var x = document.getElementById('myDIV');
                    // var x = $('myDIV');
                    if (x.style.display === 'none') {
                        x.style.display = 'block';
                    } else {
                        x.style.display = 'none';
                    }
                }

                bars = ["FineTypeA", "FineTypeB"];

                function validate(val) {
                    var total_na = 0;
                    rows = 5;
                    for (var i = 0; i < rows; i++) {
                        var missing_fine = 0;
                        var has_text = 0;
                        for (var k = 0; k < bars.length; k++) {
                            var value = $("[name='" + bars[k] + i + "']").val();


                            if ($.inArray(value, ontology) == -1) {
                                missing_fine += 1;
                            }

                            if (value.length > 0) has_text += 1;
                        }

                        var fine1_value = $("[name='" + bars[0] + i + "']").val();
                        var fine2_value = $("[name='" + bars[1] + i + "']").val();
                        var error_checked = $("[name='NA" + i + "']").is(":checked");
                        if (error_checked) {
                            total_na += 1;
                        }
                        if (error_checked && has_text == 2) {
                            alert("Sentence " + (i + 1) + " has error box checked but both specific types were entered. Please uncheck the error box or delete one or both of your input types");
                            return false;
                        }
                        if (!error_checked) {
                            if (missing_fine > 0) {
                                alert("Answers of Sentence " + (i + 1) + " has missing input or the input is not in the dropdown menu. Please input a valid type.");
                                return false;
                            }
                            if (fine1_value == fine2_value) {
                                alert("Sentence " + (i + 1) + " has repeating types. The two specific type must be distinct.");
                                return false;
                            }
                        }
                    }
                    if (total_na > 2) {
                        alert("You have checked more two rows as errors. Please review.");
                        return false;
                    }
                    if (val) alert('Your answers are ready to be submitted.');
                    return true;
                }

            </script>

            <script>

                var display_all = function (request, callback) {
                    var max = 50;
                    var search_value = request.term.toLowerCase();

                    var l0 = [];
                    var l1 = [];
                    var l2 = [];

                    for (var k = 0; k < ontology.length; k++) {
                        var current_value = ontology[k].toLowerCase();
                        if (current_value === search_value && l0.length < max) {
                            l0.push(current_value);
                            console.log(l0);
                            continue;
                        }
                        if (current_value.startsWith(search_value) && l1.length < max) {
                            l1.push(current_value);
                            continue;

                        }
                        if (current_value.includes(search_value) && l2.length < max) {
                            l2.push(current_value);
                        }
                    }
                    console.log(l0);
                    console.log(l1);
                    console.log(l2);
                    l0 = l0.concat(l1);
                    l0 = l0.concat(l2);
                    console.log(l0)
                    rv = [];
                    for (var p = 0; p < l0.length && rv.length < max; p++) {
                        if ($.inArray(l0[p], rv) == -1) rv.push(l0[p])
                    }


                    callback(rv);
                };
                rows = 5;
                for (var k = 0; k < bars.length; k++) {
                    for (var i = 0; i < rows; i++) {

                        $("[name='" + bars[k] + i + "']").autocomplete({
                            minLength: 0,
                            source: display_all,
                        });
                    }


                }
            </script>

        </div>
    </section>
    <p style="text-align: center;"><input id="valButton" onclick="return validate(true)" type="button"
                                          value="Validate"/></p>
    <p style="text-align: center;"><input id="submitButton" onclick="return validate(false)" type="submit"
                                          value="Submit"/></p>
</crowd-form>