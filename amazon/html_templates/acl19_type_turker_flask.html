<!-- Bootstrap v3.0.3 -->
<link href="https://s3.amazonaws.com/mturk-public/bs30/css/bootstrap.min.css" rel="stylesheet"/>
<section class="container" id="Other"
         style="margin-bottom: 15px; padding: 10px; font-family: Verdana, Geneva, sans-serif; font-size: 1em;">
    <meta charset="UTF-8">

    <div class="row col-xs-12 col-md-12"><!-- Instructions -->
        <div class="panel panel-primary">
            <div class="panel-heading" style="color: rgb(51, 51, 51);"><span
                    style="strong;color:white;">Instructions </span><span onclick="myFunction()"
                                                                          style="text-decoration:underline;color:white;cursor:pointer">[Hide/Show]</span>
            </div>

            <div id="myDIV">
                <div class="panel-body">


                    <p style="color: rgb(51, 51, 51);">This task is to infer the type of highlighted term in the
                        provided sentence.&nbsp;</p>

                    <p style="color: rgb(51, 51, 51);">* For each highlighted term, please select a single <b>general
                        types</b>, two <b>specific types</b>, and up to two <b>implicit types</b></p>

                    <p style="color: rgb(51, 51, 51);"><strong><em>Examples</em></strong>:</p>

                    <table border="3" cellpadding="5" cellspacing="2" style="color: rgb(51, 51, 51); font-size: 1em;">
                        <colgroup>
                            <col span="1" style="width: 35%;"/>
                            <col span="1" style="width: 20%;"/>
                            <col span="1" style="width: 20%;"/>
                            <col span="1" style="width: 20%;"/>
                            <col span="1" style="width: 5%;"/>
                        </colgroup>
                        <tbody>
                        <tr>
                            <td align="center"><strong>Sentence</strong></td>
                            <td align="center"><b>General Types</b></td>
                            <td rowspan="1" align="center"><b
                            >Specific
                                Types</b>
                            </td>
                            <td rowspan="1" align="center"><b>Implicit Types</b></td>
                            <td align="center"><b>Error</b></td>
                        </tr>
                        <tr>
                            <td>
                                轿车在
                                <mark>印度</mark>
                                市场上的地位日益重要，而日产阳光能够最大程度上满足消费者对精致、实用及高性价比车型的需要
                            </td>
                            <td>location</td>
                            <td><p>1. country</p>
                                <p>2. area</p></td>
                            <td><p>1. republic</p>
                                <p></p></td>
                            <td><input name="33" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td>
                                毛泽东与柳亚子畅游
                                <mark>颐和园</mark>
                                ，就是其中最为典型的一例
                            </td>
                            <td>location</td>
                            <td><p>1. park</p>
                                <p>2. attraction</p></td>
                            <td><p>1. heritage</p>
                                <p>2. garden</p></td>
                            <td><input name="33" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td>
                                农妇满脸丰收喜悦,
                                向我们这些分享她劳动成果的城里人连连地说:『你们随便挑哇,
                                <mark>咱</mark>
                                自家种的,八月十五快到了,买回去全家吃个鲜
                            </td>
                            <td>person</td>
                            <td><p>1. farmer</p>
                                <p>2. woman</p></td>
                            <td></td>
                            <td><input name="33" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td>
                                凯基证券分析师Kuo对苹果2012年下半年的“战况”进行了预测，Kuo认为，13英寸的
                                <mark>Retina显示屏</mark>
                                MacBook Pro以及最新款的MacBook Air对消费者的吸引力非常大
                            </td>
                            <td>object</td>
                            <td><p>1. screen</p>
                                <p>2. feature</p></td>
                            <td>1. patent</td>
                            <td><input name="33" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td>
                                而花旗银行针对新开户的个人客户，如果他们在开户时成功申请并使用三项电子银行服务，就可以获赠USB小音箱或者价值100元的
                                <mark>中国移动</mark>
                                上网卡一张
                            </td>
                            <td>organization</td>
                            <td><p>1. company</p>
                                <p>2. carrier</p></td>
                            <td><p>1. state-owned business</p>
                                <p>2. Fortune Global 500</p></td>
                            <td><input name="33" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td>
                                <mark>他</mark>
                                说,中国认为,国家不分大小、强弱和贫富,都是国际社会中平等的一员。
                                李岚清表示,中国愿意加强与爱沙尼亚在各个领域、特别是经贸领域的友好合作关系。
                            </td>
                            <td>person</td>
                            <td><p>1. speaker</p>
                                <p>2. diplomat</p></td>
                            <td></td>
                            <td><input name="33" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td>
                                <mark>张南</mark>
                                也不好反对，就交出了钥匙
                            </td>
                            <td>person</td>
                            <td></td>
                            <td></td>
                            <td><input checked="yes" name="33" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td>

                                晚会上当地的华人艺术家们演奏了精彩的中国民乐,田鸣的一首《大中国》和另一首《我爱
                                <mark>你</mark>
                                中国》将晚会的气氛推向了高潮
                            </td>
                            <td></td>
                            <td></td>
                            <td>&nbsp;</td>
                            <td><input checked="yes" type="checkbox"/></td>
                        </tr>
                        </tbody>
                    </table>

                    <p></p>
                    <p style="color: rgb(51, 51, 51);">* Highlighted terms can be pronouns or named entities. </p>

                    <p style="color: rgb(51, 51, 51);">* In each slot, a dropdown menu will appear as you type. There
                        are three categories of types in this task:
                        &nbsp;</p>
                    <style>
                        li {
                            padding: 2px;
                        }
                    </style>
                    <ul>
                        <li>For <b>general types</b>, only <a href=""> <b>9</b> entity types</a> are available. You can
                            only choose from
                            these 9.
                        </li>
                        <li>For <b>specific types</b>, the other <a href=""><b>10k</b> entity types</a> are available.
                            You can only
                            choose from
                            them.
                        </li>
                        <li>For <b>implicit types</b>, in addition to the given 10k types, you can enter <b>anything</b>
                            you
                            think is suitable for the highlighted term, with or without being inside the dropdown menu.
                            We
                            provide a shortcut for google search for the highlighted terms.
                        </li>
                        <li>Please fill-in <b>every</b> slots in both “general types” and “specific types.” For implicit
                            types,
                            out of the five entries per task, please at least complete <b>three</b> slots.
                        </li>
                    </ul>

                    <p>* A&nbsp;<strong>general&nbsp;type</strong>&nbsp;is
                        a high-level concept&nbsp;such as&nbsp;person, organization, location, event, time, concept and
                        object.&nbsp;<strong>Specific types</strong> are <strong
                        >inferred</strong><span>&nbsp;from the context. Please feel free to make a guess&nbsp;</span><strong
                        >BASED ON</strong><span>&nbsp;the context.</span>
                    </p>
                    <p>
                        * <strong>Implicit types</strong> are types that <strong>CANNOT</strong> be inferred from the
                        context, but is the definitive type of the highlighted term.
                        Here's an example:
                    <ul>
                        <li>
                            <mark>Donald Trump</mark>
                            is walking on the street.
                        </li>
                    </ul>
                    The context did not provide a lot of information about the highlighted term "Donald Trump,"
                    so in the "Specific types" category, you shouldn't label it as president, politician, or
                    businessman,
                    etc.
                    Instead, you should label it as these aforementioned types in the "Implicit types" category.
                    </p>

                    <p>*
                        For each sentence, every type you annotate must be distinct (i.e., you cannot repeat
                        person, person, person).</p>

                    <p>
                        <span>* If the sentence does not provide enough information to fill the all
                            of the required three slots, you can leave one or two of them blank and mark the </span><strong
                    >Error</strong><span>&nbsp;checkbox.&nbsp;</span>
                        Also mark the checkbox if the highlighted term simply doesn't make sense. (example 8)
                    </p>
                    <p>
                        * Please
                        read the sentence carefully and mark the checkbox&nbsp;only when&nbsp;necessary. For each
                        task with five sentences, we assume no more than two example should be marked as error.&nbsp;
                    </p>

                    <h5>*** Make sure that specific types and implicit types for each example refers to the&nbsp;<font
                            color="#ff0000"><b>subset</b></font>&nbsp;of
                        the general type. In the first example, coach and manager is subset of person. ***</h5>


                    &nbsp;

                    <p style="color: rgb(51, 51, 51);"><strong><em>Common Mistakes</em></strong></p>
                    Here we present some common mistakes. Incorrect types are written in <strong><span
                        style="color:#FF0000;">red</span></strong>, correct types in <strong><span
                        style="color:#008000;">green</span></strong>.

                    <table border="3" cellpadding="5" cellspacing="2" style="color: rgb(51, 51, 51); font-size: 1em;">
                        <colgroup>
                            <col span="1" style="width: 60%;"/>
                            <col span="1" style="width: 10%;"/>
                            <col span="1" style="width: 10%;"/>
                            <col span="1" style="width: 10%;"/>
                            <col span="1" style="width: 10%;"/>
                        </colgroup>
                        <tbody>
                        <tr>
                            <td><strong>Sentence</strong></td>
                            <td><b>General Types</b></td>
                            <td colspan="2" rowspan="1"><b
                            >Specific
                                Types</b></td>
                            <td><b>Error</b></td>
                        </tr>
                        <tr>
                            <td>He stuck
                                <mark> his hand</mark>
                                in among those that were brutally beating Steve and shot him in the chest . ''
                            </td>
                            <td><span style="color:#008000;">object</span></td>
                            <td><span style="color:#FF0000;">finger</span></td>
                            <td><span style="color:#008000;">body_part</span></td>
                            <td><input type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td colspan="5">Explanation: Finger is smaller unit than the hand, so cannot be a type of
                                hand.&nbsp;
                            </td>
                        </tr>
                        <tr>
                            <td>Lake Salar de Uyuni is covered up with a thin layer of water during
                                <mark> the rainy season</mark>
                                and turns into a huge mirror .
                            </td>
                            <td><span style="color:#008000;">time</span></td>
                            <td><span style="color:#008000;">period</span></td>
                            <td><span style="color:#FF0000;">difficulty</span></td>
                            <td><input type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td colspan="5">Explanation: It is difficult to infer rainy season is a difficulty from the
                                context. Acceptable specific types include period, season.
                            </td>
                        </tr>
                        <tr>
                            <td>``
                                <mark> I</mark>
                                would n't make all that much of it , '' said Carter , who has worked as a consultant for
                                the Rose Bowl , as well as analyzing Los Angeles sites .
                            </td>
                            <td><span style="color:#008000;">person</span></td>
                            <td><span style="color:#008000;">analyst</span></td>
                            <td><span style="color:#FF0000;">media</span></td>
                            <td><input type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td colspan="5">Explanation: While working in the media, here ``I" is a person, which does
                                not belong to concept media. Other suitable specific types include professional,
                                consultant, employee.
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <p style="color: rgb(51, 51, 51);">&nbsp;</p>

                    <p style="color: rgb(51, 51, 51);"><span
                    >The followings&nbsp;</span><strong
                    ><span style="color: rgb(255, 0, 0);">are not</span></strong><span
                    >&nbsp;considered as types: Pronouns&nbsp;</span><span
                    >(i.e., you, them, they, I, it, he, she, self), Quantifying expressions</span><span
                    >&nbsp;(i.e., all, both, many), Names (i.e., Jon, Mary, George), Adjective or adverb (i.e., ancient, beautiful, religious).</span>
                    </p>

                    <p style="color: rgb(51, 51, 51);"><span
                    >Feel free to send questions, Thanks for your interest in the task!</span>
                    </p>
                </div>
            </div>
        </div>

        <form action="postdata" method="POST">

            <section style="color: rgb(51, 51, 51);">
                <!--<div style="display:none;">${InputID1}${InputID2}${InputID3}${InputID4}${InputID5}</div>-->

                <fieldset>
                    <table border="3" cellpadding="15" cellspacing="2" style="font-size:1em;">
                        <colgroup>
                            <col span="1" style="width: 35%;"/>
                            <col span="1" style="width: 20%;"/>
                            <col span="1" style="width: 20%;"/>
                            <!--<col span="1" style="width: 12%;"/>-->
                            <!--<col span="1" style="width: 12%;"/>-->
                            <col span="1" style="width: 20%;"/>
                            <col span="1" style="width: 5%;"/>

                        </colgroup>
                        <tbody>

                        <tr>
                            <td align="center"><strong>Sentence</strong></td>
                            <td align="center"><b>General Types</b></td>
                            <td rowspan="1" align="center"><b
                            >Specific
                                Types</b>
                            </td>
                            <td rowspan="1" align="center"><b>Implicit Types</b></td>
                            <td align="center"><b>Error</b></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">{{post[0].left}}
                                <mark>{{post[0].mention}}</mark>
                                {{post[0].right}}
                                <p></p>
                                <a href="https://www.google.com/search?q={{post[0].mention}}" target="_blank">google
                                    search: {{post[0].mention}}</a>
                            </td>
                            <td><input class="form-control" id="txt1" name="GenType0" size="15" type="text"/></td>
                            <td><input class="form-control" name="FineTypeA0" size="15" type="text"/>
                                <p></p><input class="form-control" name="FineTypeB0" size="15" type="text"/></td>
                            <td><input class="form-control" name="ImplicitTypeA0" size="15" type="text"/>
                                <p></p><input class="form-control" name="ImplicitTypeB0" size="15" type="text"/></td>
                            <td><input name="NA0" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">{{post[1].left}}
                                <mark>{{post[1].mention}}</mark>
                                {{post[1].right}}
                                <p></p>
                                <a href="https://www.google.com/search?q={{post[1].mention}}" target="_blank">google
                                    search: {{post[1].mention}}</a>
                            </td>
                            <td><input class="form-control" id="txt2" name="GenType1" size="15" type="text"/></td>
                            <td><input class="form-control" name="FineTypeA1" size="15" type="text"/>
                                <p></p><input class="form-control" name="FineTypeB1" size="15" type="text"/></td>
                            <td><input class="form-control" name="ImplicitTypeA1" size="15" type="text"/>
                                <p></p><input class="form-control" name="ImplicitTypeB1" size="15" type="text"/></td>
                            <td><input name="NA1" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">{{post[2].left}}
                                <mark>{{post[2].mention}}</mark>
                                {{post[2].right}}
                                <p></p>
                                <a href="https://www.google.com/search?q={{post[2].mention}}" target="_blank">google
                                    search: {{post[2].mention}}</a>
                            </td>
                            <td><input class="form-control" name="GenType2" size="15" type="text"/></td>
                            <td><input class="form-control" name="FineTypeA2" size="15" type="text"/>
                                <p></p><input class="form-control" name="FineTypeB2" size="15" type="text"/></td>
                            <td><input class="form-control" name="ImplicitTypeA2" size="15" type="text"/>
                                <p></p><input class="form-control" name="ImplicitTypeB2" size="15" type="text"/></td>
                            <td><input name="NA2" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">{{post[3].left}}
                                <mark>{{post[3].mention}}</mark>
                                {{post[3].right}}
                                <p></p>
                                <a href="https://www.google.com/search?q={{post[3].mention}}" target="_blank">google
                                    search: {{post[3].mention}}</a>
                            </td>
                            <td><input class="form-control" name="GenType3" size="15" type="text"/></td>
                            <td><input class="form-control" name="FineTypeA3" size="15" type="text"/>
                                <p></p><input class="form-control" name="FineTypeB3" size="15" type="text"/></td>
                            <td><input class="form-control" name="ImplicitTypeA3" size="15" type="text"/>
                                <p></p><input class="form-control" name="ImplicitTypeB3" size="15" type="text"/></td>
                            <td><input name="NA3" type="checkbox"/></td>
                        </tr>
                        <tr>
                            <td style="font-size: 15px;">{{post[4].left}}
                                <mark>{{post[4].mention}}</mark>
                                {{post[4].right}}
                                <p></p>
                                <a href="https://www.google.com/search?q={{post[4].mention}}" target="_blank">google
                                    search: {{post[4].mention}}</a>
                            </td>
                            <td><input class="form-control" name="GenType4" size="15"/></td>
                            <td><input class="form-control" name="FineTypeA4" size="15"/>
                                <p></p><input class="form-control" name="FineTypeB4" size="15"/></td>
                            <td><input class="form-control" name="ImplicitTypeA4" size="15" type="text"/>
                                <p></p><input class="form-control" name="ImplicitTypeB4" size="15" type="text"/></td>
                            <td><input name="NA4" type="checkbox"/></td>
                        </tr>
                        </tbody>
                    </table>
                </fieldset>
            </section>
            <p style="text-align: center;"><input id="submitButton" onclick="return validate()" type="submit"
                                                  value="Submit"/></p>
        </form>

    </div>
</section>
<link href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css" rel="stylesheet"/>
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<script src="https://s3.amazonaws.com/MY89_js/jquery.cookie.js"></script>

<script>
    function myFunction() {
        var x = document.getElementById('myDIV');
        // var x = $('myDIV');
        if (x.style.display === 'none') {
            x.style.display = 'block';
        } else {
            x.style.display = 'none';
        }
    }

    bars = ["GenType", "FineTypeA", "FineTypeB", "ImplicitTypeA", 'ImplicitTypeB'];
    rows = 5;

    function validate() {
        if ({{test}}) return true;
        var total_na = 0;
        for (var i = 0; i < rows; i++) {
            var missing = 0;
            var has_text = 0;
            var has_implicit = 0;
            var ontology_gen = {{ontology_gen | safe}}
            var ontology_all = {{ontology_all | safe}}

            for (var k = 0; k < bars.length; k++) {
                var value = $("[name='" + bars[k] + i + "']").val()
                // console.log(value)
                if (bars[k] == 'GenType' && $.inArray(value, ontology_gen) == -1) missing = k + 1;
                if (bars[k] == 'FineTypeA' && $.inArray(value, ontology_all) == -1) missing = k + 1;
                if (bars[k] == 'FineTypeB' && $.inArray(value, ontology_all) == -1) {
                    missing = k + 1;
                    // alert(value)
                    // console.log(ontology_all)
                    // alert($.inArray(value.toString(), ontology_all))
                    // alert(ontology_all.indexOf(value))
                    // alert(ontology_all)
                }
                if (bars[k] == 'ImplicitTypeA' && value.length > 0) has_implicit += 1;
                if (bars[k] == 'ImplicitTypeB' && value.length > 0) has_implicit += 1;
                if (value.length > 0) has_text = 1;
            }
            // alert(missing)
            var gen_value = $("[name='" + bars[0] + i + "']").val();
            var fine1_value = $("[name='" + bars[1] + i + "']").val();
            var fine2_value = $("[name='" + bars[2] + i + "']").val();
            var imp1_value = $("[name='" + bars[3] + i + "']").val();
            var imp2_value = $("[name='" + bars[4] + i + "']").val();
            var na_value = $("[name='NA" + i + "']").is(":checked");
            if (na_value) {
                total_na += 1;
            }
            // if (value && has_text) {
            //     alert("row " + (i + 1) + " has ignore checked but boxes have values");
            //     return false;
            // }
            // if (!value) {
            if (missing > 0) {
                alert("row " + (i + 1) + ", box " + missing + " is empty or has a value that does not match dropdown");
                return false;
            }
            var arr = [gen_value, fine1_value, fine2_value]
            var set = new Set(arr);
            if (set.size != arr.length) {
                alert("row " + (i + 1) + " has repeating types. General type and two specific type must be distinct.");
                return false;
            }
            // }
        }
        if (total_na > 2) {
            alert("You have clicked more two rows as errors. Please review.");
            return false;
        }
        if ((has_implicit < 3 && total_na < 2) || (has_implicit < 2 && total_na == 2)) {
            alert("please enter at least 3 implicit types");
            return false;
        }
        return true;

    }

</script>


<!--<script src="https://homes.cs.washington.edu/~eunsol/data/ontology.js"></script>-->

<script>
    var display_gen = function (request, callback) {
        var max = 20;
        var search_value = request.term.toLowerCase();
        var l0 = [[], [], [], [], [], [], [], [], []];
        var l1 = [[], [], [], [], [], [], [], [], []];
        var l2 = [];
        var ontology = {{ontology_gen | safe}}
        ;
        for (var k = 0; k < ontology.length; k++) {
            var current_value = ontology[k].toLowerCase();
            var splits = current_value.split(" ");
            for (var p = 0; p < splits.length; p++) {
                if (splits[p] === search_value) {
                    l0[p].push(current_value);
                    break;
                }
                if (splits[p].startsWith(search_value)) {
                    l1[p].push(current_value);
                    break;
                }
            }
            if (current_value.includes(search_value)) {
                l2.push(current_value);
            }
        }
        rv = [];
        for (var p = 0; p < l0.length && rv.length < max; p++) {
            for (var i = 0; i < l0[p].length; i++) {
                if ($.inArray(l0[p][i], rv) == -1) rv.push(l0[p][i])
            }
        }
        ;
        for (var p = 0; p < l1.length && rv.length < max; p++) {
            for (var i = 0; i < l1[p].length; i++) {
                if ($.inArray(l1[p][i], rv) == -1) rv.push(l1[p][i])
            }
        }
        ;
        for (var i = 0; i < l2.length && rv.length < max; i++) {
            if ($.inArray(l2[i], rv) == -1) rv.push(l2[i])
        }
        ;
        callback(rv);
    }

    var display_all = function (request, callback) {
        var max = 100;
        var search_value = request.term.toLowerCase();
        var l0 = [[], [], [], [], [], [], [], [], []];
        var l1 = [[], [], [], [], [], [], [], [], []];
        var l2 = [];
        var ontology = {{ontology_all | safe}};
        for (var k = 0; k < ontology.length; k++) {
            // if (ontology[k] == '规'){
            //     alert(ontology[k].toLowerCase())
            // }
            var current_value = ontology[k].toLowerCase();
            var splits = current_value.split(" ");
            for (var p = 0; p < splits.length; p++) {
                if (splits[p] === search_value) {
                    l0[p].push(current_value);
                    break;
                }
                if (splits[p].startsWith(search_value)) {
                    l1[p].push(current_value);
                    break;
                }
            }
            if (current_value.includes(search_value)) {
                l2.push(current_value);
            }
        }
        // alert(l1)
        rv = [];
        for (var p = 0; p < l0.length && rv.length < max; p++) {
            for (var i = 0; i < l0[p].length && rv.length < max; i++) {
                if ($.inArray(l0[p][i], rv) == -1) rv.push(l0[p][i])
            }
        }
        ;

        for (var p = 0; p < l1.length && rv.length < max; p++) {
            for (var i = 0; i < l1[p].length && rv.length < max; i++) {
                if ($.inArray(l1[p][i], rv) == -1) rv.push(l1[p][i])
            }
        }
        ;

        for (var i = 0; i < l2.length && rv.length < max; i++) {
            if ($.inArray(l2[i], rv) == -1) rv.push(l2[i])
        }
        ;
        // alert(rv);
        // alert(rv.length);
        callback(rv);
    }

    for (var k = 0; k < bars.length; k++) {
        for (var i = 0; i < rows; i++) {
            if (k == 0) {
                $("[name='" + bars[k] + i + "']").autocomplete({
                    minLength: 0,
                    source: display_gen
                });
            } else {
                $("[name='" + bars[k] + i + "']").autocomplete({
                    minLength: 0,
                    source: display_all
                });
            }


        }
    }
</script>
<p></p>


